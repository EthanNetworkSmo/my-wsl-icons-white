# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Christian Lempa EXACT Windows Setup (commit 8dbebcf)
# Uses Christian's Windows configs + YOUR white icons
# Applies proper bashrc with Starship for all WSL distros
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#Requires -RunAsAdministrator
$ErrorActionPreference = 'Continue'
$ProgressPreference = 'SilentlyContinue'

Write-Host @"
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   Christian Lempa Windows Setup (commit 8dbebcf)              â•‘
â•‘   ğŸ¯ Windows configs from ChristianLempa/dotfiles             â•‘
â•‘   ğŸ¨ YOUR white icons from EthanNetworkSmo                    â•‘
â•‘   âš™ï¸  Bashrc + Starship for Ubuntu/Kali/Arch                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"@ -ForegroundColor Cyan

# Pre-flight
if (-not (Test-Connection 8.8.8.8 -Count 1 -Quiet)) { Write-Host "[âœ—] No internet" -ForegroundColor Red; Exit 1 }
if (-not (Get-Command winget -ErrorAction SilentlyContinue)) {
    Invoke-WebRequest -Uri https://aka.ms/getwinget -OutFile $env:TEMP\winget.msixbundle -UseBasicParsing
    Add-AppxPackage $env:TEMP\winget.msixbundle
}
winget source update 2>$null

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 1: WINDOWS CUSTOMIZATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 1: Windows Customization â•â•" -ForegroundColor Cyan

Write-Host "[1/50] Dark mode..." -ForegroundColor Green
Set-ItemProperty "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "AppsUseLightTheme" -Value 0 -Force -EA SilentlyContinue
Set-ItemProperty "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" -Name "SystemUseLightTheme" -Value 0 -Force -EA SilentlyContinue

Write-Host "[2/50] Taskbar..." -ForegroundColor Green
Set-ItemProperty "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" -Name "SearchboxTaskbarMode" -Value 0 -Force -EA SilentlyContinue
Set-ItemProperty "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "TaskbarAl" -Value 0 -Force -EA SilentlyContinue

Write-Host "[3/50] Mr. Robot wallpaper..." -ForegroundColor Green
$wallPath = "$env:USERPROFILE\Pictures\mrrobot.png"
mkdir "$env:USERPROFILE\Pictures" -Force -EA SilentlyContinue | Out-Null
try {
    Invoke-WebRequest "https://raw.githubusercontent.com/ChristianLempa/hackbox/main/src/assets/mr-robot-wallpaper.png" -OutFile $wallPath -UseBasicParsing -TimeoutSec 30
    Add-Type 'using System.Runtime.InteropServices; public class W { [DllImport("user32.dll")] public static extern int SystemParametersInfo(int a,int b,string c,int d); }'
    [W]::SystemParametersInfo(0x14,0,$wallPath,0x03)
} catch {}

Stop-Process -Name explorer -Force -EA SilentlyContinue; Start-Sleep 2

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 2: WSL2
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 2: WSL2 Setup â•â•" -ForegroundColor Cyan

Write-Host "[4/50] Enabling WSL2..." -ForegroundColor Green
dism /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart | Out-Null
dism /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart | Out-Null
dism /online /enable-feature /featurename:Microsoft-Hyper-V /all /norestart | Out-Null

Write-Host "[5/50] WSL2 kernel..." -ForegroundColor Green
try {
    $k="$env:TEMP\wsl.msi"; Invoke-WebRequest "https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi" -OutFile $k -UseBasicParsing
    Start-Process msiexec -ArgumentList "/i $k /quiet /norestart" -Wait -NoNewWindow; Remove-Item $k -Force -EA SilentlyContinue
} catch {}
wsl --set-default-version 2 2>$null

Write-Host "[6/50] Ubuntu 22.04..." -ForegroundColor Green
try {
    $ua="$env:TEMP\U.appx"; Invoke-WebRequest "https://aka.ms/wslubuntu2204" -OutFile $ua -UseBasicParsing -TimeoutSec 60
    Add-AppxPackage $ua; Remove-Item $ua -Force -EA SilentlyContinue
} catch { Start-Process winget -ArgumentList "install","-e","--id","Canonical.Ubuntu.2204","--silent" -Wait -NoNewWindow }

Write-Host "[7/50] Kali Linux..." -ForegroundColor Green
try {
    $ka="$env:TEMP\K.appx"; Invoke-WebRequest "https://aka.ms/wsl-kali-linux-new" -OutFile $ka -UseBasicParsing -TimeoutSec 60
    Add-AppxPackage $ka; Remove-Item $ka -Force -EA SilentlyContinue
} catch { Start-Process winget -ArgumentList "install","-e","--id","KaliLinux.KaliLinux","--silent" -Wait -NoNewWindow }

Write-Host "[8/50] Arch Linux..." -ForegroundColor Green
$archDir="$env:LOCALAPPDATA\Arch"; $archOk=$false
try {
    $az="$env:TEMP\A.zip"; Invoke-WebRequest "https://github.com/yuk7/ArchWSL/releases/download/22.10.16.0/Arch.zip" -OutFile $az -UseBasicParsing -TimeoutSec 120
    if (Test-Path $archDir) { Remove-Item $archDir -Recurse -Force }
    Expand-Archive $az -Destination $archDir -Force; Remove-Item $az -Force -EA SilentlyContinue
    if (Test-Path "$archDir\Arch.exe") { $archOk=$true }
} catch {}
if (-not $archOk) { Start-Process winget -ArgumentList "install","-e","--id","yuk7.arch","--silent" -Wait -NoNewWindow }

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 3: TOOLS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 3: Tools Installation â•â•" -ForegroundColor Cyan

$tools=@(
    @{N=9;Name="Windows Terminal";Id="Microsoft.WindowsTerminal"},
    @{N=10;Name="PowerShell 7";Id="Microsoft.PowerShell"},
    @{N=11;Name="Git";Id="Git.Git"},
    @{N=12;Name="VS Code";Id="Microsoft.VisualStudioCode"},
    @{N=13;Name="Docker";Id="Docker.DockerDesktop"},
    @{N=14;Name="kubectl";Id="Kubernetes.kubectl"},
    @{N=15;Name="Helm";Id="Helm.Helm"},
    @{N=16;Name="Terraform";Id="Hashicorp.Terraform"},
    @{N=17;Name="Starship";Id="Starship.Starship"},
    @{N=18;Name="Python";Id="Python.Python.3.11"},
    @{N=19;Name="Node.js";Id="OpenJS.NodeJS"}
)

foreach ($t in $tools) {
    Write-Host "[$($t.N)/50] $($t.Name)..." -ForegroundColor Green
    Start-Process winget -ArgumentList "install","-e","--id",$t.Id,"--silent","--accept-package-agreements" -Wait -NoNewWindow 2>$null
    Start-Sleep -Milliseconds 200
}

$env:Path=[System.Environment]::GetEnvironmentVariable("Path","Machine")+";"+[System.Environment]::GetEnvironmentVariable("Path","User")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 4: HACK NERD FONT
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 4: Hack Nerd Font â•â•" -ForegroundColor Cyan
Write-Host "[20/50] Installing..." -ForegroundColor Green

$fontReg="HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts"
if ((Get-ItemProperty $fontReg -EA SilentlyContinue).PSObject.Properties.Name -notmatch "Hack.*Nerd") {
    try {
        $fz="$env:TEMP\H.zip"; Invoke-WebRequest "https://github.com/ryanoasis/nerd-fonts/releases/download/v3.0.2/Hack.zip" -OutFile $fz -UseBasicParsing -TimeoutSec 120
        $fe="$env:TEMP\H"; Expand-Archive $fz -Destination $fe -Force
        Get-ChildItem "$fe\*.ttf" | ForEach-Object {
            $d="$env:WINDIR\Fonts\$($_.Name)"
            if (!(Test-Path $d)) { Copy-Item $_.FullName $d -Force; New-ItemProperty -Path $fontReg -Name $_.BaseName -Value $_.Name -Force -EA SilentlyContinue | Out-Null }
        }
        Remove-Item $fz,$fe -Recurse -Force -EA SilentlyContinue
    } catch {}
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 5: CLONE CHRISTIAN'S DOTFILES (commit 8dbebcf - Windows branch)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 5: Christian's Dotfiles (Windows) â•â•" -ForegroundColor Cyan
Write-Host "[21/50] Cloning Windows configs (commit 8dbebcf)..." -ForegroundColor Green

$dotfiles="$env:USERPROFILE\dotfiles"
if (Test-Path $dotfiles) { Remove-Item $dotfiles -Recurse -Force -EA SilentlyContinue }

try {
    git clone https://github.com/ChristianLempa/dotfiles.git $dotfiles 2>&1 | Out-Null
    if (Test-Path $dotfiles) {
        Set-Location $dotfiles
        git checkout 8dbebcfca2c4f1e067540c6ae33ac913668d452f 2>&1 | Out-Null
        Write-Host "[âœ“] Dotfiles at commit 8dbebcf (Windows configs)" -ForegroundColor Green
    }
} catch { Write-Host "[!] Clone failed" -ForegroundColor Yellow }

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 6: YOUR WHITE ICONS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 6: YOUR White Icons â•â•" -ForegroundColor Cyan
$iconsDir="$env:USERPROFILE\WindowsTerminalIcons"
mkdir $iconsDir -Force | Out-Null

Write-Host "[22/50] Downloading YOUR white icons..." -ForegroundColor Green

$yourIcons=@{
    "ubuntu.png"="https://raw.githubusercontent.com/EthanNetworkSmo/my-wsl-icons-white/main/wsl-icons/icons8-ubuntu-24.png"
    "kali.png"="https://raw.githubusercontent.com/EthanNetworkSmo/my-wsl-icons-white/main/wsl-icons/icons8-fsociety-mask-50.png"
    "arch.png"="https://raw.githubusercontent.com/EthanNetworkSmo/my-wsl-icons-white/main/wsl-icons/icons8-arch-linux-24.png"
    "ps.png"="https://raw.githubusercontent.com/EthanNetworkSmo/my-wsl-icons-white/main/wsl-icons/icons8-powershell-24.png"
    "cmd.png"="https://raw.githubusercontent.com/EthanNetworkSmo/my-wsl-icons-white/main/wsl-icons/icons8-cmd-50.png"
}

foreach ($icon in $yourIcons.Keys) {
    try {
        Invoke-WebRequest $yourIcons[$icon] -OutFile "$iconsDir\$icon" -UseBasicParsing -TimeoutSec 15
        Write-Host "[âœ“] $icon" -ForegroundColor Gray
    } catch { Write-Host "[!] $icon failed" -ForegroundColor Yellow }
}

Write-Host "[âœ“] All white icons downloaded to: $iconsDir" -ForegroundColor Green

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 7: WINDOWS TERMINAL SETTINGS (Christian's xcad theme + YOUR icons)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 7: Windows Terminal Settings â•â•" -ForegroundColor Cyan
Write-Host "[23/50] Applying Christian's xcad theme + YOUR white icons..." -ForegroundColor Green

$termPath="$env:LOCALAPPDATA\Packages\Microsoft.WindowsTerminal_8wekyb3d8bbwe\LocalState"
mkdir $termPath -Force -EA SilentlyContinue | Out-Null
$settingsFile="$termPath\settings.json"
$iconPath="%userprofile%\\WindowsTerminalIcons"

# Christian's EXACT settings.json with xcad_tdl theme + YOUR white icons
$terminalSettings=@"
{
    "`$help": "https://aka.ms/terminal-documentation",
    "`$schema": "https://aka.ms/terminal-profiles-schema",
    "actions": [],
    "alwaysShowNotificationIcon": false,
    "defaultProfile": "{07b52e3e-de2c-5db4-bd2d-ba144ed6c273}",
    "firstWindowPreference": "defaultProfile",
    "profiles": {
        "defaults": {
            "colorScheme": "xcad_tdl",
            "font": {
                "face": "Hack Nerd Font",
                "size": 14
            },
            "historySize": 12000,
            "opacity": 95,
            "scrollbarState": "visible",
            "useAcrylic": false
        },
        "list": [
            {
                "guid": "{07b52e3e-de2c-5db4-bd2d-ba144ed6c273}",
                "hidden": false,
                "icon": "$iconPath\\ubuntu.png",
                "name": "Ubuntu Linux",
                "source": "Windows.Terminal.Wsl"
            },
            {
                "guid": "{46ca431a-3a87-5fb3-83cd-11ececc031d2}",
                "hidden": false,
                "icon": "$iconPath\\kali.png",
                "name": "Kali Linux",
                "source": "Windows.Terminal.Wsl"
            },
            {
                "commandline": "wsl.exe -d Arch",
                "guid": "{a5a97cb8-8961-5535-816d-772efe0c6a3f}",
                "hidden": false,
                "icon": "$iconPath\\arch.png",
                "name": "Arch Linux",
                "source": "Windows.Terminal.Wsl"
            },
            {
                "commandline": "cmd.exe",
                "guid": "{0caa0dad-35be-5f56-a8ff-afceeeaa6101}",
                "icon": "$iconPath\\cmd.png",
                "name": "Commandline"
            },
            {
                "commandline": "pwsh.exe --NoLogo",
                "guid": "{574e775e-4f2a-5b96-ac1e-a2962a402336}",
                "hidden": false,
                "icon": "$iconPath\\ps.png",
                "name": "PowerShell",
                "source": "Windows.Terminal.PowershellCore"
            }
        ]
    },
    "schemes": [
        {
            "background": "#080808",
            "black": "#0A0A0A",
            "blue": "#0037DA",
            "brightBlack": "#767676",
            "brightBlue": "#3B78FF",
            "brightCyan": "#61D6D6",
            "brightGreen": "#16C60C",
            "brightPurple": "#B4009E",
            "brightRed": "#E74856",
            "brightWhite": "#F2F2F2",
            "brightYellow": "#F9F1A5",
            "cursorColor": "#FFFFFF",
            "cyan": "#3A96DD",
            "foreground": "#CCCCCC",
            "green": "#13A10E",
            "name": "Campbell",
            "purple": "#881798",
            "red": "#C50F1F",
            "selectionBackground": "#FFFFFF",
            "white": "#CCCCCC",
            "yellow": "#C19C00"
        },
        {
            "background": "#111927",
            "black": "#000000",
            "blue": "#004CFF",
            "brightBlack": "#666666",
            "brightBlue": "#5CB2FF",
            "brightCyan": "#5CECC6",
            "brightGreen": "#C5F467",
            "brightPurple": "#AE81FF",
            "brightRed": "#FF8484",
            "brightWhite": "#FFFFFF",
            "brightYellow": "#FFCC5C",
            "cursorColor": "#FFFFFF",
            "cyan": "#2EE7B6",
            "foreground": "#D4D4D4",
            "green": "#9FEF00",
            "name": "xcad_hackthebox",
            "purple": "#BC3FBC",
            "red": "#FF3E3E",
            "selectionBackground": "#FFFFFF",
            "white": "#FFFFFF",
            "yellow": "#FFAF00"
        },
        {
            "background": "#1A1A1A",
            "black": "#121212",
            "blue": "#2B4FFF",
            "brightBlack": "#2F2F2F",
            "brightBlue": "#5C78FF",
            "brightCyan": "#5AC8FF",
            "brightGreen": "#905AFF",
            "brightPurple": "#5EA2FF",
            "brightRed": "#BA5AFF",
            "brightWhite": "#FFFFFF",
            "brightYellow": "#685AFF",
            "cursorColor": "#FFFFFF",
            "cyan": "#28B9FF",
            "foreground": "#F1F1F1",
            "green": "#7129FF",
            "name": "xcad_tdl",
            "purple": "#2883FF",
            "red": "#A52AFF",
            "selectionBackground": "#FFFFFF",
            "white": "#F1F1F1",
            "yellow": "#3D2AFF"
        },
        {
            "background": "#0F0F0F",
            "black": "#000000",
            "blue": "#2878FF",
            "brightBlack": "#2F2F2F",
            "brightBlue": "#5E99FF",
            "brightCyan": "#5AD6FF",
            "brightGreen": "#FFB15A",
            "brightPurple": "#935CFF",
            "brightRed": "#FF755A",
            "brightWhite": "#FFFFFF",
            "brightYellow": "#FFD25A",
            "cursorColor": "#FFFFFF",
            "cyan": "#28C8FF",
            "foreground": "#F1F1F1",
            "green": "#FF9A28",
            "name": "xcad_tdl_colorful",
            "purple": "#732BFF",
            "red": "#FF4C27",
            "selectionBackground": "#FFFFFF",
            "white": "#F1F1F1",
            "yellow": "#FFC72A"
        },
        {
            "background": "#0F0F0F",
            "black": "#000000",
            "blue": "#184AE8",
            "brightBlack": "#5F5F5F",
            "brightBlue": "#4771F5",
            "brightCyan": "#31C1FF",
            "brightGreen": "#FFD631",
            "brightPurple": "#7631FF",
            "brightRed": "#FF3190",
            "brightWhite": "#FFFFFF",
            "brightYellow": "#FF9731",
            "cursorColor": "#FFFFFF",
            "cyan": "#008DCB",
            "foreground": "#D9D9D9",
            "green": "#CBA300",
            "name": "xcad_tdl_old",
            "purple": "#4300CB",
            "red": "#CB005F",
            "selectionBackground": "#FFFFFF",
            "white": "#CFCFCF",
            "yellow": "#CB6600"
        },
        {
            "background": "#282C34",
            "black": "#000000",
            "blue": "#007ACC",
            "brightBlack": "#75715E",
            "brightBlue": "#11A8CD",
            "brightCyan": "#11A8CD",
            "brightGreen": "#0DBC79",
            "brightPurple": "#AE81FF",
            "brightRed": "#DD6B65",
            "brightWhite": "#F8F8F2",
            "brightYellow": "#E6DB74",
            "cursorColor": "#FFFFFF",
            "cyan": "#11A8CD",
            "foreground": "#D4D4D4",
            "green": "#0DBC79",
            "name": "xcad_vscode",
            "purple": "#BC3FBC",
            "red": "#F4423A",
            "selectionBackground": "#FFFFFF",
            "white": "#F8F8F2",
            "yellow": "#E5E510"
        }
    ],
    "showTabsInTitlebar": true,
    "tabSwitcherMode": "inOrder",
    "useAcrylicInTabRow": true
}
"@

Set-Content $settingsFile -Value $terminalSettings -Force
Write-Host "[âœ“] Christian's xcad_tdl theme + YOUR white icons applied!" -ForegroundColor Green

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 8: STARSHIP CONFIG (Christian's starship.toml)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 8: Starship Config â•â•" -ForegroundColor Cyan
Write-Host "[24/50] Copying Christian's starship.toml..." -ForegroundColor Green

$starshipDir="$env:USERPROFILE\.config"
mkdir $starshipDir -Force | Out-Null

$starshipSource="$dotfiles\.config\starship.toml"
if (Test-Path $starshipSource) {
    Copy-Item $starshipSource "$starshipDir\starship.toml" -Force
    Write-Host "[âœ“] Christian's starship.toml copied" -ForegroundColor Green
} else {
    Write-Host "[!] starship.toml not found, using fallback" -ForegroundColor Yellow
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 9: POWERSHELL PROFILE (Christian's Microsoft.PowerShell_profile.ps1)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 9: PowerShell Profile â•â•" -ForegroundColor Cyan
Write-Host "[25/50] Creating Christian's PowerShell profile..." -ForegroundColor Green

$pwshDir="$env:USERPROFILE\Documents\PowerShell"
mkdir $pwshDir -Force | Out-Null

$pwshProfile=@'
New-Alias k kubectl
Remove-Alias h -EA SilentlyContinue
New-Alias h helm
New-Alias g goto -EA SilentlyContinue

function goto {
    param ($location)
    Switch ($location) {
        "pr" { Set-Location -Path "$HOME/projects" }
        "bp" { Set-Location -Path "$HOME/projects/boilerplates" }
        "cs" { Set-Location -Path "$HOME/projects/cheat-sheets" }
        default { echo "Invalid location" }
    }
}

function kn {
    param ($namespace)
    if ($namespace -in "default","d") {
        kubectl config set-context --current --namespace=default
    } else {
        kubectl config set-context --current --namespace=$namespace
    }
}

$ENV:STARSHIP_CONFIG = "$HOME\.config\starship.toml"
$ENV:STARSHIP_DISTRO = "  $env:username"
Invoke-Expression (&starship init powershell)
'@

Set-Content "$pwshDir\Microsoft.PowerShell_profile.ps1" -Value $pwshProfile -Force
Write-Host "[âœ“] Christian's PowerShell profile created" -ForegroundColor Green

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PHASE 10: WSL BASHRC + STARSHIP INSTALLER
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`nâ•â• PHASE 10: WSL Bashrc + Starship Installer â•â•" -ForegroundColor Cyan
Write-Host "[26/50] Creating WSL installer script..." -ForegroundColor Green

$wslInstaller=@'
Write-Host "`nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
Write-Host "â•‘  Installing Christian Lempa WSL Setup          â•‘" -ForegroundColor Cyan
Write-Host "â•‘  Bashrc + Starship for Ubuntu/Kali/Arch       â•‘" -ForegroundColor Cyan
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan

function Install-WSLStarship {
    param([string]$Distro,[string]$Name)
    Write-Host "`n[*] Configuring $Name..." -ForegroundColor Green
    
    $script=@"
#!/bin/bash
set -e
echo '[$Name] Installing prerequisites...'
if command -v apt >/dev/null; then
    sudo apt update -y 2>/dev/null && sudo apt install -y curl git neofetch 2>/dev/null
elif command -v pacman >/dev/null; then
    sudo pacman -Sy --noconfirm curl git neofetch 2>/dev/null
fi

echo '[$Name] Installing Starship...'
curl -sS https://starship.rs/install.sh | sh -s -- -y

echo '[$Name] Downloading Christian Lempa starship.toml...'
mkdir -p ~/.config
curl -sS https://raw.githubusercontent.com/ChristianLempa/dotfiles/8dbebcfca2c4f1e067540c6ae33ac913668d452f/.config/starship.toml -o ~/.config/starship.toml

echo '[$Name] Configuring bashrc with distro icons...'
cat > ~/.bashrc << 'BASHRC'
# find out which distribution we are running on
LFILE="/etc/*-release"
MFILE="/System/Library/CoreServices/SystemVersion.plist"
_distro=\$(awk '/^ID=/' /etc/*-release | awk -F'=' '{ print tolower(\$2) }')

# set an icon based on the distro
case \$_distro in
    *kali*)                  ICON="ï´£";;
    *arch*)                  ICON="";;
    *debian*)                ICON="";;
    *raspbian*)              ICON="";;
    *ubuntu*)                ICON="";;
    *elementary*)            ICON="";;
    *fedora*)                ICON="";;
    *coreos*)                ICON="";;
    *gentoo*)                ICON="";;
    *mageia*)                ICON="";;
    *centos*)                ICON="";;
    *opensuse*|*tumbleweed*) ICON="";;
    *sabayon*)               ICON="";;
    *slackware*)             ICON="";;
    *linuxmint*)             ICON="";;
    *alpine*)                ICON="";;
    *aosc*)                  ICON="";;
    *nixos*)                 ICON="";;
    *devuan*)                ICON="";;
    *manjaro*)               ICON="";;
    *rhel*)                  ICON="";;
    *macos*)                 ICON="";;
    *)                       ICON="";;
esac

export STARSHIP_DISTRO="\$ICON "
export STARSHIP_CONFIG=~/.config/starship.toml
eval "\$(starship init bash)"

# PATH Variable
export PATH="\$PATH:\$HOME/.local/bin"
export PATH="\$PATH:\$HOME/.cargo/bin"

# Bash History Settings
HISTCONTROL=ignoreboth
HISTSIZE=1000
HISTFILESIZE=2000

shopt -s histappend
shopt -s checkwinsize

# Aliases
alias k="kubectl"
alias h="helm"
alias tf="terraform"
alias gs="git status"
alias ga="git add"
alias gc="git commit"
alias gp="git push"

# Run neofetch on login
neofetch

# enable programmable completion features
if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  elif [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
  fi
fi
BASHRC

echo '[$Name] âœ“ Complete! Restart terminal to see changes.'
"@
    
    try {
        $test=wsl -d $Distro echo OK 2>&1
        if ($LASTEXITCODE -eq 0) {
            $script | wsl -d $Distro bash
            Write-Host "[âœ“] $Name configured successfully!" -ForegroundColor Green
        } else {
            Write-Host "[!] $Name not initialized - run distro first" -ForegroundColor Yellow
        }
    } catch {
        Write-Host "[!] $Name error: $($_.Exception.Message)" -ForegroundColor Red
    }
}

Start-Sleep 3
Install-WSLStarship "Ubuntu-22.04" "Ubuntu"
Install-WSLStarship "kali-linux" "Kali"
Install-WSLStarship "Arch" "Arch"

Write-Host "`nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Green
Write-Host "â•‘       âœ“ ALL WSL DISTROS CONFIGURED!           â•‘" -ForegroundColor Green
Write-Host "â•‘       Christian Lempa's exact setup!           â•‘" -ForegroundColor Green
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Green
Write-Host "`nStarship installed with distro icons:"
Write-Host "  ï´£ Kali Linux"
Write-Host "   Arch Linux"
Write-Host "   Ubuntu"
Write-Host "`nRestart your terminal to see the changes!"
Write-Host "Press any key..."
$null=$Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
Remove-Item $PSCommandPath -Force -EA SilentlyContinue
'@

Set-Content "$env:USERPROFILE\Desktop\Install-WSL-Starship.ps1" -Value $wslInstaller -Force
Write-Host "[âœ“] WSL installer created on Desktop" -ForegroundColor Green

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# FINAL SUMMARY
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Write-Host "`n`nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Green
Write-Host "â•‘     ğŸ‰ CHRISTIAN LEMPA WINDOWS SETUP COMPLETE! ğŸ‰            â•‘" -ForegroundColor Green
Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Green

Write-Host "`nâœ… WHAT WAS INSTALLED:" -ForegroundColor Yellow
Write-Host ""
Write-Host "  ğŸ“¦ FROM CHRISTIAN'S REPO (commit 8dbebcf):" -ForegroundColor Cyan
Write-Host "    â€¢ Windows Terminal settings.json" -ForegroundColor White
Write-Host "    â€¢ starship.toml configuration" -ForegroundColor White
Write-Host "    â€¢ PowerShell profile with aliases" -ForegroundColor White
Write-Host "    â€¢ Bashrc with distro icon detection" -ForegroundColor White
Write-Host "    â€¢ xcad_tdl color scheme (purple-blue)" -ForegroundColor White
Write-Host ""
Write-Host "  ğŸ¨ YOUR WHITE ICONS:" -ForegroundColor Cyan
Write-Host "    â€¢  Ubuntu (white)" -ForegroundColor White
Write-Host "    â€¢ ï´£ Kali (fsociety mask)" -ForegroundColor White
Write-Host "    â€¢  Arch (white)" -ForegroundColor White
Write-Host "    â€¢  PowerShell (white)" -ForegroundColor White
Write-Host "    â€¢  CMD (white)" -ForegroundColor White
Write-Host "    Location: $iconsDir" -ForegroundColor Gray
Write-Host ""
Write-Host "  ğŸ› ï¸  TOOLS INSTALLED:" -ForegroundColor Cyan
Write-Host "    â€¢ WSL2: Ubuntu, Kali, Arch" -ForegroundColor White
Write-Host "    â€¢ Docker, kubectl, Helm, Terraform" -ForegroundColor White
Write-Host "    â€¢ Windows Terminal, PowerShell 7, VS Code" -ForegroundColor White
Write-Host "    â€¢ Starship prompt, Hack Nerd Font" -ForegroundColor White

Write-Host "`nğŸ¨ WHAT YOU'LL SEE:" -ForegroundColor Magenta
Write-Host ""
Write-Host "  Windows Terminal:" -ForegroundColor Yellow
Write-Host "    â€¢ YOUR white icons in tabs" -ForegroundColor Gray
Write-Host "    â€¢ Christian's xcad_tdl theme (purple-blue)" -ForegroundColor Gray
Write-Host "    â€¢ Hack Nerd Font size 14" -ForegroundColor Gray
Write-Host ""
Write-Host "  PowerShell Prompt:" -ForegroundColor Yellow
Write-Host "    â€¢ â•­â•´  username at ~/path" -ForegroundColor Gray
Write-Host "    â€¢ â•°â”€ " -ForegroundColor Gray
Write-Host ""
Write-Host "  WSL Bash Prompt (Ubuntu/Kali/Arch):" -ForegroundColor Yellow
Write-Host "    â€¢ â•­â•´  username at ~/path on  main" -ForegroundColor Gray
Write-Host "    â€¢ â•°â”€ " -ForegroundColor Gray
Write-Host "    â€¢ Distro icons: ï´£ (Kali)  (Arch)  (Ubuntu)" -ForegroundColor Gray

Write-Host "`nğŸ¯ NEXT STEPS:" -ForegroundColor Magenta
Write-Host "  1. RESTART COMPUTER NOW" -ForegroundColor White -NoNewline
Write-Host " (Required for WSL2)" -ForegroundColor Gray
Write-Host "  2. After restart, launch each WSL distro:" -ForegroundColor White
Write-Host "     â€¢ Start Menu â†’ Ubuntu 22.04" -ForegroundColor Gray
Write-Host "     â€¢ Start Menu â†’ Kali Linux" -ForegroundColor Gray
Write-Host "     â€¢ Start Menu â†’ Arch" -ForegroundColor Gray
Write-Host "     (First launch will take 2-3 min to initialize)" -ForegroundColor Gray
Write-Host "  3. Run the Desktop installer:" -ForegroundColor White
Write-Host "     " -NoNewline
Write-Host "Desktop\Install-WSL-Starship.ps1" -ForegroundColor Yellow
Write-Host "  4. Open Windows Terminal â†’ See Christian's setup!" -ForegroundColor White

Write-Host "`nğŸ“‚ FOLDERS CREATED:" -ForegroundColor Cyan
Write-Host "  â€¢ $dotfiles" -ForegroundColor Gray
Write-Host "  â€¢ $iconsDir" -ForegroundColor Gray
Write-Host "  â€¢ $starshipDir" -ForegroundColor Gray

Write-Host "`nğŸ’¡ TIP:" -ForegroundColor Yellow
Write-Host "  Christian's setup uses:" -ForegroundColor White
Write-Host "    â€¢ 'k' alias for kubectl" -ForegroundColor Gray
Write-Host "    â€¢ 'h' alias for helm" -ForegroundColor Gray
Write-Host "    â€¢ 'tf' alias for terraform" -ForegroundColor Gray
Write-Host "    â€¢ 'kn <namespace>' to switch k8s namespace" -ForegroundColor Gray
Write-Host "    â€¢ 'g pr' to go to projects folder" -ForegroundColor Gray

Write-Host "`nPress any key to RESTART..."
$null=$Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
Write-Host "Restarting in 10 seconds..." -ForegroundColor Yellow
Start-Sleep 10
Restart-Computer -Force